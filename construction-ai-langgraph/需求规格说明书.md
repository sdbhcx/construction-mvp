# 📋 施工记录智能识别系统 - 需求规格说明书

## 文档信息

| 项目               | 内容                               |
| ------------------ | ---------------------------------- |
| **文档名称** | 施工记录智能识别系统需求规格说明书 |
| **版本号**   | V2.0                               |
| **编制部门** | 技术研发部                         |
| **编制人**   | AI系统架构组                       |
| **审核人**   | 技术委员会                         |
| **批准人**   | CTO                                |
| **生效日期** | 2026年1月15日                      |
| **文档状态** | 正式发布                           |

## 1. 项目概述

### 1.1 项目背景

随着基建行业数字化转型加速，施工记录管理仍依赖人工录入和整理，存在效率低、易出错、数据孤岛等问题。本项目旨在利用AI技术，实现施工记录图片/文档的自动识别和结构化处理。

### 1.2 项目目标

**核心目标** ：构建一个多模态智能系统，自动识别施工记录中的关键信息，实现从纸质/电子记录到结构化数据的自动化转换。

### 1.3 项目范围

| 范围类型           | 包含                             | 不包含                       |
| ------------------ | -------------------------------- | ---------------------------- |
| **数据输入** | JPG/PNG图片、PDF、DOC/DOCX文档   | 视频、音频、手绘草图         |
| **处理类型** | 施工日志、质量检查表、安全检查表 | 工程图纸、合同文档、财务票据 |
| **输出格式** | JSON结构化数据、数据库存储       | 自定义报表生成、BI分析       |
| **用户角色** | 现场工程师、项目管理员           | 系统管理员、财务人员         |

## 2. 业务需求

### 2.1 用户画像

| 角色                 | 核心需求                       | 使用场景                         |
| -------------------- | ------------------------------ | -------------------------------- |
| **现场工程师** | 快速录入施工记录，减少手动输入 | 现场拍摄记录→自动识别→复核确认 |
| **资料员**     | 批量处理历史记录，建立电子档案 | 批量扫描→自动识别→数据入库     |
| **项目经理**   | 实时掌握项目进展，数据可追溯   | 数据看板→进度追踪→问题预警     |
| **质量安全员** | 质量问题跟踪，安全隐患记录     | 检查表识别→问题归类→整改跟踪   |

### 2.2 业务流程图

```
现场记录流程：
1. 现场拍照/扫描 → 2. 上传系统 → 3. AI自动识别 → 4. 人工复核 → 5. 确认入库

批量处理流程：
1. 批量上传 → 2. 队列处理 → 3. 批量复核 → 4. 数据导出 → 5. 系统对接

数据应用流程：
1. 数据查询 → 2. 统计分析 → 3. 报告生成 → 4. 预警推送 → 5. 决策支持
```

### 2.3 核心业务场景

#### 场景一：用户上传新施工记录（自动识别流程）

**流程描述**：
1. **用户上传**：通过Web界面上传图片或PDF文件
2. **智能调度**：智能体调度中心接收任务，启动信息抽取智能体
3. **OCR识别**：调用OCR服务，提取文档中所有文本及位置
4. **实体抽取**：调用领域NER模型，快速从OCR文本中抽取初步实体
5. **VLM精炼**：将原始图片和NER结果输入微调后的VLM，进行校验、补全和精炼
6. **临时存储**：将JSON结果存入临时数据库，并推送至人工复核队列
7. **人工复核**：复核通过后，数据进入结构化业务数据库
8. **向量索引**：原始文本和关键信息被索引到向量数据库

**技术要求**：
- OCR识别准确率≥95%
- NER实体抽取准确率≥90%
- VLM多模态理解准确率≥85%
- 端到端处理时间≤30秒

#### 场景二：用户进行对话查询

**流程描述**：
1. **用户提问**：用户在聊天框提问，如"上个月B区有哪些安全隐患？"
2. **意图识别**：智能体调度中心启动问答与查询智能体，进行意图识别与工具规划
3. **SQL查询**：根据意图生成SQL查询，获取结构化数据
4. **向量检索**：如需要，在向量库中进行相似性检索，补充更多细节
5. **答案合成**：LLM将工具返回的结构化数据和文本片段，组织成自然语言回答
6. **返回结果**：将答案返回给用户，并可附上相关图片链接

**技术要求**：
- 意图识别准确率≥90%
- SQL生成准确率≥85%
- 向量检索召回率≥80%
- 端到端响应时间≤3秒

## 3. 系统架构

### 3.1 总体架构

```
┌─────────────────────────────────────────────────────────┐
│                   用户交互层                             │
│   - Web界面（Vue/React）                                │
│   - 移动端适配                                          │
└─────────────────────────────────────────────────────────┘
                               ↓
┌─────────────────────────────────────────────────────────┐
│                   API网关层                              │
│   - 身份认证和授权                                      │
│   - 请求路由和限流                                      │
│   - 输入验证和清洗                                      │
└─────────────────────────────────────────────────────────┘
                               ↓
┌─────────────────────────────────────────────────────────┐
│                多Agent协同层（核心）                     │
│                                                         │
│   ┌─────────┐  ┌─────────┐  ┌─────────┐                │
│   │ 智能体调度器│  │ 信息抽取智能体│  │ 问答查询智能体│           │
│   └─────────┘  └─────────┘  └─────────┘                │
│        │            │            │                      │
│   ┌────────────────────────────────────────┐           │
│   │          消息队列/事件总线              │           │
│   └────────────────────────────────────────┘           │
│        │            │            │                      │
│   ┌─────────┐  ┌─────────┐  ┌─────────┐                │
│   │ OCR节点  │  │ NER节点  │  │ VLM节点  │               │
│   └─────────┘  └─────────┘  └─────────┘                │
└─────────────────────────────────────────────────────────┘
                               ↓
┌─────────────────────────────────────────────────────────┐
│                数据与基础设施层                          │
│   - 关系数据库（PostgreSQL）                            │
│   - 向量数据库（Chroma/Milvus）                        │
│   - 文件存储（对象存储/本地）                            │
│   - 缓存（Redis）                                       │
│   - 模型服务（ONNX/TensorFlow Serving）                 │
└─────────────────────────────────────────────────────────┘
```

### 3.2 Agent架构设计

#### 3.2.1 智能体调度器（Orchestrator）

**职责**：
- 系统入口，请求接收和预处理
- 多模态输入识别和路由
- 基础验证和上下文关联
- 标准化任务消息生成
- 异步消息发布

**核心功能**：
- 请求类型识别（上传/查询）
- 智能体选择和任务分配
- 任务状态跟踪和监控
- 异常处理和重试机制

#### 3.2.2 信息抽取智能体（Information Extraction Agent）

**职责**：
- 处理图片和文档输入
- 执行多模态信息抽取
- 生成结构化施工记录数据

**核心功能**：
- **OCR识别**：提取文档中所有文本及位置信息
- **领域NER**：快速从OCR文本中抽取初步实体（项目、部位、日期、工程量等）
- **多模态VLM**：结合原始图片和NER结果进行校验、补全和精炼
- **数据存储**：将JSON结果存入临时数据库
- **人工复核**：推送至人工复核队列

**技术栈**：
- OCR：PaddleOCR/Tesseract
- NER：自定义领域模型（基于BERT）
- VLM：Qwen-VL/LLaVA
- 数据库：PostgreSQL（临时存储）

#### 3.2.3 问答与查询智能体（QA Query Agent）

**职责**：
- 处理自然语言查询
- 意图识别和工具规划
- SQL查询生成和执行
- 向量检索和答案合成

**核心功能**：
- **意图识别**：LLM分析问题，判断需要调用哪些工具
- **SQL查询**：生成并执行SQL查询，获取结构化数据
- **向量检索**：在向量库中进行相似性检索，补充更多细节
- **答案合成**：将结构化数据和文本片段组织成自然语言回答

**技术栈**：
- LLM：GPT-4/Qwen-72B
- 向量数据库：Chroma/Milvus
- SQL生成：Text-to-SQL模型
- 数据库：PostgreSQL（结构化数据）

### 3.3 数据流转

```
场景一：施工记录自动识别
原始输入（图片/PDF）→ OCR文本提取 → NER实体抽取 → VLM多模态精炼
→ 临时数据库存储 → 人工复核 → 结构化业务数据库 → 向量数据库索引

场景二：智能对话查询
用户提问 → 意图识别 → SQL查询生成 → 数据库查询 → 向量检索
→ 答案合成 → 自然语言回答 → 返回用户
```

## 4. 功能需求

### 4.1 核心功能模块

#### 4.1.1 多模态识别模块

| 功能点               | 详细描述                 | 验收标准                |
| -------------------- | ------------------------ | ----------------------- |
| **图片识别**   | 支持施工记录照片自动识别 | 识别准确率≥90%         |
| **PDF解析**    | 支持施工日志PDF文件解析  | 支持多页PDF，保持格式   |
| **表格识别**   | 识别施工记录表格结构     | 表格结构识别准确率≥85% |
| **手写体识别** | 支持工程师手写内容识别   | 手写体识别准确率≥70%   |
| **混合文档**   | 图文混合文档综合识别     | 关键信息提取完整率≥95% |

#### 4.1.2 智能复核模块

| 功能点               | 详细描述                       | 验收标准                |
| -------------------- | ------------------------------ | ----------------------- |
| **复核界面**   | 三栏式对比界面，支持快速修正   | 单条记录复核时间≤2分钟 |
| **智能提示**   | 基于历史数据提供修正建议       | 建议采纳率≥60%         |
| **批量操作**   | 支持批量确认、批量修正         | 批量处理效率提升50%     |
| **置信度显示** | 显示AI识别置信度，高亮可疑字段 | 置信度校准误差≤10%     |

#### 4.1.3 智能查询模块

| 功能点               | 详细描述                       | 验收标准                |
| -------------------- | ------------------------------ | ----------------------- |
| **自然语言查询** | 支持自然语言提问               | 意图识别准确率≥90%     |
| **SQL生成**   | 自动生成SQL查询语句           | SQL生成准确率≥85%       |
| **向量检索**   | 基于语义相似度的检索           | 检索召回率≥80%         |
| **答案合成**   | 生成自然语言回答               | 回答满意度≥85%         |

#### 4.1.4 数据管理模块

| 功能点             | 详细描述                     | 验收标准               |
| ------------------ | ---------------------------- | ---------------------- |
| **数据存储** | 结构化数据存储，支持快速检索 | 查询响应时间≤500ms    |
| **版本管理** | 记录数据修改历史，支持回滚   | 版本追溯完整率100%     |
| **数据导出** | 支持Excel、JSON、CSV格式导出 | 导出数据格式正确率100% |
| **数据统计** | 自动生成处理统计报表         | 报表生成时间≤10秒     |

#### 4.1.5 模型管理模块

| 功能点             | 详细描述                   | 验收标准             |
| ------------------ | -------------------------- | -------------------- |
| **模型训练** | 基于反馈数据的增量训练     | 训练后准确率提升≥5% |
| **模型评估** | 定期评估模型性能           | 评估报告自动生成     |
| **版本发布** | 模型版本管理，支持灰度发布 | 版本回滚时间≤5分钟  |
| **A/B测试**  | 新旧模型对比测试           | 测试数据自动收集     |

### 4.2 性能需求

| 指标                 | 要求                | 备注                       |
| -------------------- | ------------------- | -------------------------- |
| **响应时间**   | 单张图片处理≤30秒  | 复杂文档≤60秒             |
| **查询响应**   | 自然语言查询≤3秒   | 复杂查询≤5秒              |
| **并发处理**   | 支持50用户同时在线  | 支持10个并发任务           |
| **系统可用性** | ≥99.5%             | 月度宕机时间≤3.6小时      |
| **数据准确性** | 核心字段准确率≥95% | P0字段（项目、部位、日期） |
| **系统吞吐量** | 1000张/天处理能力   | 平均每张20秒               |

### 4.3 安全需求

| 安全领域           | 要求                   | 措施                   |
| ------------------ | ---------------------- | ---------------------- |
| **数据安全** | 数据传输加密，存储脱敏 | HTTPS、数据加密存储    |
| **访问控制** | RBAC权限管理，操作审计 | 用户-角色-权限三级控制 |
| **操作审计** | 所有操作可追溯         | 完整操作日志记录       |
| **防攻击**   | SQL注入、XSS防护       | 输入验证、WAF防护      |

## 5. 非功能需求

### 5.1 可用性

* **操作便捷** ：界面符合用户习惯，学习成本≤10分钟
* **容错设计** ：支持断点续传，错误自动恢复
* **帮助系统** ：内置操作指引和常见问题解答

### 5.2 可维护性

* **模块化设计** ：各模块解耦，支持独立升级
* **配置化管理** ：系统参数可配置，无需代码修改
* **监控告警** ：关键指标监控，异常自动告警

### 5.3 可扩展性

* **插件机制** ：支持新识别模型快速接入
* **API接口** ：提供标准RESTful API
* **数据接口** ：支持与主流工程管理系统对接

### 5.4 兼容性

| 兼容项             | 要求                              |
| ------------------ | --------------------------------- |
| **浏览器**   | Chrome 90+、Firefox 88+、Edge 90+ |
| **移动端**   | iOS 13+、Android 10+              |
| **文件格式** | JPG、PNG、PDF、DOC、DOCX          |
| **分辨率**   | 支持720p-4K图片识别               |

## 6. 数据需求

### 6.1 数据字段定义

| 字段类别           | 字段名                | 类型   | 必填 | 说明     | 示例                   |
| ------------------ | --------------------- | ------ | ---- | -------- | ---------------------- |
| **项目信息** | project_name          | string | ✓   | 项目名称 | "京沪高速G2标段"       |
|                    | project_code          | string | ✓   | 项目编号 | "JHGS-G2-2024"         |
| **施工信息** | construction_location | string | ✓   | 施工部位 | "K3+500桥梁桩基"       |
|                    | date                  | date   | ✓   | 施工日期 | "2024-05-15"           |
|                    | weather               | string | ✓   | 天气情况 | "晴，25-30°C"         |
| **工作内容** | work_content          | string | ✓   | 主要工作 | "桩基混凝土浇筑"       |
|                    | quantity              | string | ✓   | 工程量   | "120m³"               |
|                    | unit                  | string | ✓   | 单位     | "立方米"               |
| **资源投入** | workers               | string | ✓   | 施工人员 | "钢筋工8人，模板工6人" |
|                    | machinery             | string | ✓   | 机械设备 | "挖掘机2台，吊车1台"   |
| **质量安全** | quality_status        | string | ✓   | 质量状况 | "合格"                 |
|                    | issues                | string | ✓   | 存在问题 | "钢筋间距偏大5mm"      |
|                    | safety_records        | string | ✓   | 安全记录 | "班前安全教育已进行"   |
| **人员信息** | inspector             | string | ✓   | 记录人   | "张三"                 |
|                    | supervisor            | string | ✓   | 监理     | "李四"                 |

### 6.2 数据质量要求

| 指标             | 要求                    | 测量方法       |
| ---------------- | ----------------------- | -------------- |
| **完整性** | 必填字段完整率≥98%     | 抽样检查       |
| **准确性** | 字段准确率≥95%         | 与人工标注对比 |
| **一致性** | 同一项目数据一致性≥99% | 跨记录对比     |
| **及时性** | 数据当日处理率≥95%     | 处理时间统计   |

### 6.3 数据量预估

| 项目                   | 数量       | 说明                         |
| ---------------------- | ---------- | ---------------------------- |
| **日新增记录**   | 500-1000份 | 按10个项目，每个项目50-100份 |
| **单份记录大小** | 1-5MB      | 含图片和结构化数据           |
| **日数据增量**   | 2-5GB      | 原始文件存储                 |
| **年数据总量**   | 0.7-1.8TB  | 考虑压缩和清理               |
| **结构化数据**   | 10-20KB/份 | JSON格式存储                 |

## 7. 接口需求

### 7.1 外部系统接口

| 系统名称               | 接口类型 | 数据流向         | 频率      | 协议               |
| ---------------------- | -------- | ---------------- | --------- | ------------------ |
| **工程管理系统** | 数据推送 | 本系统→工程系统 | 实时/定时 | RESTful API        |
| **文件存储系统** | 文件存取 | 双向同步         | 实时      | S3/OSS API         |
| **统一认证系统** | 用户认证 | 工程系统→本系统 | 实时      | OAuth 2.0          |
| **消息通知系统** | 消息推送 | 本系统→用户     | 实时      | WebSocket/消息队列 |

### 7.2 第三方服务接口

| 服务名称             | 用途       | SLA   | 备选方案          |
| -------------------- | ---------- | ----- | ----------------- |
| **OCR服务**    | 文字识别   | 99.9% | PaddleOCR（本地） |
| **大模型服务** | 多模态理解 | 99.5% | Qwen-VL（本地）   |
| **向量数据库** | 语义检索   | 99.9% | Chroma（本地）    |
| **对象存储**   | 文件存储   | 99.9% | 本地存储          |
| **短信服务**   | 通知提醒   | 99%   | 邮件通知          |

## 8. 部署需求

### 8.1 硬件需求

| 环境                | 服务器配置      | 存储                | 网络    |
| ------------------- | --------------- | ------------------- | ------- |
| **测试环境**  | 4核8G×2        | 500GB SSD           | 100Mbps |
| **生产环境**  | 8核16G×4       | 2TB SSD×3（RAID5） | 1Gbps   |
| **GPU服务器** | 8核32G + A10×2 | 1TB NVMe            | 1Gbps   |

### 8.2 软件环境

| 组件               | 版本             | 说明           |
| ------------------ | ---------------- | -------------- |
| **操作系统** | Ubuntu 20.04 LTS | 生产环境推荐   |
| **容器平台** | Docker 20.10+    | Kubernetes可选 |
| **数据库**   | PostgreSQL 14+   | 主从复制       |
| **向量数据库** | Chroma/Milvus   | 语义检索       |
| **缓存**     | Redis 7.0+       | 集群模式       |
| **消息队列** | RabbitMQ 3.10+   | 或Kafka        |
| **对象存储** | MinIO            | 或阿里云OSS    |

### 8.3 网络要求

| 要求               | 说明                               |
| ------------------ | ---------------------------------- |
| **公网访问** | HTTPS访问，域名备案                |
| **内网互通** | 与工程管理系统内网互通             |
| **VPN支持**  | 支持VPN接入现场网络                |
| **防火墙**   | 只开放必要端口（80,443,5432,6379） |

## 9. 项目约束

### 9.1 技术约束

| 约束项               | 说明               | 影响           |
| -------------------- | ------------------ | -------------- |
| **国产化要求** | 优先使用国产技术栈 | 影响技术选型   |
| **数据安全**   | 数据不出境         | 影响云服务选择 |
| **性能要求**   | 单张图片处理≤30秒 | 影响算法复杂度 |
| **成本控制**   | 硬件成本≤50万/年  | 影响服务器配置 |

### 9.2 时间约束

| 里程碑             | 时间点 | 交付物                 |
| ------------------ | ------ | ---------------------- |
| **MVP 0.5**  | 第2周  | 技术验证报告、原型演示 |
| **MVP 1.0**  | 第5周  | 基础复核系统、数据收集 |
| **MVP 1.5**  | 第9周  | 效率优化、移动端支持   |
| **正式上线** | 第15周 | 完整系统、运维手册     |

### 9.3 质量约束

| 质量指标           | 标准              | 验证方法   |
| ------------------ | ----------------- | ---------- |
| **代码质量** | 测试覆盖率≥80%   | 自动化测试 |
| **文档完整** | API文档覆盖率100% | 文档审查   |
| **安全合规** | 无高危漏洞        | 安全扫描   |
| **用户体验** | NPS≥8分          | 用户调研   |

## 10. 风险分析

### 10.1 技术风险

| 风险项                     | 概率 | 影响 | 缓解措施                                      |
| -------------------------- | ---- | ---- | --------------------------------------------- |
| **模型准确率不达标** | 中   | 高   | 1. 多模型融合 2. 人工复核机制 3. 持续训练优化 |
| **并发性能不足**     | 低   | 中   | 1. 水平扩展 2. 异步处理 3. 缓存优化           |
| **手写体识别困难**   | 高   | 中   | 1. 专用手写体模型 2. 人工辅助 3. 模板标准化   |

### 10.2 业务风险

| 风险项                 | 概率 | 影响 | 缓解措施                              |
| ---------------------- | ---- | ---- | ------------------------------------- |
| **用户接受度低** | 中   | 高   | 1. 渐进式推广 2. 激励机制 3. 持续培训 |
| **数据质量问题** | 高   | 中   | 1. 数据清洗 2. 质量检查 3. 反馈机制   |
| **需求变更频繁** | 中   | 中   | 1. 敏捷开发 2. 模块化设计 3. 定期沟通 |

### 10.3 管理风险

| 风险项             | 概率 | 影响 | 缓解措施                              |
| ------------------ | ---- | ---- | ------------------------------------- |
| **工期延误** | 低   | 高   | 1. 定期评审 2. 风险缓冲 3. 并行开发   |
| **资源不足** | 中   | 中   | 1. 外部协作 2. 优先级调整 3. 增量交付 |

## 11. 验收标准

### 11.1 功能验收

| 功能模块           | 验收项   | 验收标准        | 测试用例             |
| ------------------ | -------- | --------------- | -------------------- |
| **文件上传** | 支持格式 | JPG/PNG/PDF/DOC | 上传10种不同格式文件 |
|                    | 批量上传 | 支持≤50个文件  | 同时上传50个文件     |
| **智能识别** | 准确率   | P0字段≥95%     | 100份样本测试        |
|                    | 处理时间 | ≤30秒/张       | 100张批量测试        |
| **人工复核** | 复核效率 | ≤2分钟/张      | 10名用户测试         |
|                    | 操作便捷 | 满意度≥4.5/5   | 用户调研问卷         |
| **智能查询** | 意图识别 | 准确率≥90%     | 50个问题测试         |
|                    | 响应时间 | ≤3秒/查询      | 100个查询测试        |

### 11.2 性能验收

| 测试项             | 测试场景 | 性能指标          | 通过标准     |
| ------------------ | -------- | ----------------- | ------------ |
| **单用户**   | 上传识别 | 响应时间≤5秒     | 95%请求达标  |
| **并发测试** | 50并发   | 吞吐量≥10张/分钟 | 系统无宕机   |
| **压力测试** | 100并发  | 错误率≤1%        | 系统稳定运行 |
| **耐久测试** | 24小时   | 内存泄漏≤5%      | 资源稳定     |

### 11.3 安全验收

| 安全项             | 测试方法     | 通过标准           |
| ------------------ | ------------ | ------------------ |
| **认证授权** | 越权访问测试 | 无法访问未授权资源 |
| **数据加密** | 网络抓包测试 | 敏感信息加密传输   |
| **SQL注入**  | 安全扫描     | 无高危漏洞         |
| **XSS攻击**  | 渗透测试     | 无安全漏洞         |

### 11.4 用户验收

| 验收环节             | 参与人员       | 验收内容   | 通过标准         |
| -------------------- | -------------- | ---------- | ---------------- |
| **UAT测试**    | 现场工程师10名 | 全流程使用 | 问题数≤3个      |
| **可用性测试** | 资料员5名      | 界面操作   | 学习时间≤30分钟 |
| **集成测试**   | 系统管理员     | 系统对接   | 数据同步正常     |
| **上线评审**   | 项目委员会     | 整体评估   | 全票通过         |

## 12. 附录

### 12.1 术语表

| 术语               | 解释                                       |
| ------------------ | ------------------------------------------ |
| **P0字段**   | 核心业务字段，包括项目名称、施工部位、日期 |
| **置信度**   | AI模型对识别结果的自信程度，0-1之间        |
| **多模态**   | 同时处理文本、图像等多种类型数据           |
| **数据飞轮** | 通过用户反馈持续优化模型的闭环系统         |
| **Agent**    | 具有特定功能的智能处理单元                 |
| **VLM**      | Vision-Language Model，视觉语言模型         |
| **NER**      | Named Entity Recognition，命名实体识别       |

### 12.2 参考资料

1. 《建筑工程施工记录规范》GB/T 50328-2014
2. 《电子文件归档与电子档案管理规范》GB/T 18894-2016
3. 《人工智能系统安全评估指南》GB/T 39412-2020
4. LangChain官方文档：https://python.langchain.com/
5. LangGraph官方文档：https://langchain-ai.github.io/langgraph/

### 12.3 变更记录

| 版本 | 日期       | 修改人 | 修改内容       | 审核状态 |
| ---- | ---------- | ------ | -------------- | -------- |
| V1.0 | 2024-01-16 | 王五   | 初始版本       | 已批准   |
| V2.0 | 2026-01-15 | AI架构组 | 重构Agent架构，增加智能查询场景 | 已批准   |
